<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sukhpreet's Era - Study Companion</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #475569; }
        
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-in {
          animation: fadeIn 0.4s ease-out forwards;
        }
        
        /* Hide scrollbar for horizontal scrolling areas */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-[#0f172a] text-slate-100 selection:bg-indigo-500/30">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- Icons (SVG Components to avoid external dependencies) ---
        const Icon = ({ path, size = 24, className = "", strokeWidth = 2, fill = "none" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill={fill} 
                stroke="currentColor" 
                strokeWidth={strokeWidth} 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {path}
            </svg>
        );

        const Icons = {
            CheckCircle2: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></>} />,
            Circle: (props) => <Icon {...props} path={<circle cx="12" cy="12" r="10"/>} />,
            Target: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></>} />,
            BellOff: (props) => <Icon {...props} path={<><path d="M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5"/><path d="M17 17H7"/><path d="M22 22 2 2"/><path d="M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5"/><path d="M17 17H7"/><path d="M22 22 2 2"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></>} />,
            BookOpen: (props) => <Icon {...props} path={<><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></>} />,
            BarChart3: (props) => <Icon {...props} path={<><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></>} />,
            Play: (props) => <Icon {...props} path={<polygon points="5 3 19 12 5 21 5 3"/>} />,
            Pause: (props) => <Icon {...props} path={<><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></>} />,
            RotateCcw: (props) => <Icon {...props} path={<><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></>} />,
            Home: (props) => <Icon {...props} path={<><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></>} />,
            BrainCircuit: (props) => <Icon {...props} path={<><path d="M12 4.5a2.5 2.5 0 0 0-4.96-.46 2.5 2.5 0 0 0-1.98 3 2.5 2.5 0 0 0-1.32 3 2.5 2.5 0 0 0 .84 4.15 2.5 2.5 0 0 0 3.83 2.68 2.5 2.5 0 0 0 5.18 0 2.5 2.5 0 0 0 3.83-2.68 2.5 2.5 0 0 0 .84-4.15 2.5 2.5 0 0 0-1.32-3 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 12 4.5Z"/><path d="M12 8v8"/><path d="M8.5 14c.83-1.1 1.3-2.5 1.3-4"/><path d="M15.5 14c-.83-1.1-1.3-2.5-1.3-4"/></>} />,
            FileWarning: (props) => <Icon {...props} path={<><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M12 9v4"/><path d="M12 17h.01"/></>} />,
            Trash2: (props) => <Icon {...props} path={<><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></>} />,
            AlertTriangle: (props) => <Icon {...props} path={<><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></>} />,
            Calendar: (props) => <Icon {...props} path={<><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></>} />,
            ChevronLeft: (props) => <Icon {...props} path={<polyline points="15 18 9 12 15 6"/>} />,
            ChevronRight: (props) => <Icon {...props} path={<polyline points="9 18 15 12 9 6"/>} />,
            Clock: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>} />,
            Book: (props) => <Icon {...props} path={<><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></>} />,
        };

        // --- Configuration & Data ---

        const EXAM_DATE = new Date('2025-02-12T00:00:00');

        const SUBJECTS_DATA = [
            { 
                id: 'math', name: 'Mathematics', color: 'text-red-400',
                chapters: [
                'संबंध एवं फलन (Relations & Functions)', 
                'प्रतिलोम त्रिकोणमितीय फलन (Inverse Trig)', 
                'आव्यूह (Matrices)', 
                'सारणिक (Determinants)', 
                'सांतत्य तथा अवकलनीयता (Continuity & Diff)', 
                'अवकलज के अनुप्रयोग (AOD)', 
                'समाकलन (Integrals)', 
                'समाकलनो के अनुप्रयोग (AOI)', 
                'अवकल समीकरण (Differential Eq)', 
                'सदिश बीजगणित (Vector Algebra)', 
                'त्रिविमीय ज्यामिति (3D Geometry)', 
                'प्रायिकता (Probability)'
                ]
            },
            { 
                id: 'phy', name: 'Physics', color: 'text-blue-400', 
                chapters: [
                'वैद्युत आवेश तथा क्षेत्र (Electric Charges & Fields)', 
                'स्थिरवैद्युत विभव तथा धारिता (Potential & Capacitance)', 
                'विद्युत धारा (Current Electricity)', 
                'गतिमान आवेश और चुंबकत्व (Moving Charges)', 
                'चुंबकत्व एवं द्रव्य (Magnetism)', 
                'वैद्युतचुंबकीय प्रेरण (EMI)', 
                'प्रत्यावर्ती धारा (AC)', 
                'वैद्युतचुंबकीय तरंगें (EM Waves)', 
                'किरण प्रकाशिकी (Ray Optics)', 
                'तरंग-प्रकाशिकी (Wave Optics)', 
                'विकिरण तथा द्रव्य की द्वैत प्रकृति (Dual Nature)', 
                'परमाणु (Atoms)', 
                'नाभिक (Nuclei)', 
                'अर्धचालक इलेक्ट्रॉनिकी (Semiconductors)'
                ] 
            },
            { 
                id: 'chem', name: 'Chemistry', color: 'text-yellow-400',
                chapters: [
                'विलयन (Solutions)', 
                'वैद्युतरसायन (Electrochemistry)', 
                'रासायनिक बलगतिकी (Chemical Kinetics)', 
                'd- एवं f- ब्लॉक के तत्त्व (d & f Block)', 
                'उपसहसंयोजन यौगिक (Coordination Compounds)', 
                'हैलोएल्केन तथा हैलोएरीन (Haloalkanes)', 
                'एल्कोहल, फिनॉल एवं ईथर (Alcohols)', 
                'एल्डिहाइड, कीटोन एवं कार्बोक्सिलिक अम्ल', 
                'एमीन (Amines)', 
                'जैव-अणु (Biomolecules)'
                ]
            },
            {
                id: 'eng', name: 'English', color: 'text-green-400',
                chapters: ['Reading Comprehension', 'Creative Writing Skills', 'Flamingo (Prose)', 'Flamingo (Poetry)', 'Vistas (Supplementary)']
            }
        ];

        const DEFAULT_ROUTINE = [
            { id: '1', start: '04:00', end: '04:15', title: 'Wake Up', focus: 'Hydrate, No Phone', completed: false, type: 'basic' },
            { id: '2', start: '04:15', end: '04:25', title: 'Meditation', focus: '10 min Mindfulness', completed: false, type: 'basic' },
            { id: '3', start: '04:25', end: '04:55', title: 'Exercise', focus: 'Cardio/Stretching', completed: false, type: 'basic' },
            { id: '4', start: '04:55', end: '05:15', title: 'Shower & Snack', focus: 'Cold Shower, Fruit/Nuts', completed: false, type: 'basic' },
            { id: '5', start: '05:15', end: '07:15', title: 'Session 1: Hardest', focus: 'Physics/Chem Theory', completed: false, type: 'study' },
            { id: '6', start: '07:15', end: '07:30', title: 'Break', focus: 'Stretch, Hydrate', completed: false, type: 'break' },
            { id: '7', start: '07:30', end: '09:30', title: 'Session 2: Core', focus: 'Maths (Concepts & Practice)', completed: false, type: 'study' },
            { id: '8', start: '09:30', end: '10:15', title: 'Breakfast', focus: 'Nutritious Meal', completed: false, type: 'break' },
            { id: '9', start: '10:15', end: '12:15', title: 'Session 3: Medium', focus: 'Chemistry (Memorization)', completed: false, type: 'study' },
            { id: '10', start: '12:15', end: '12:30', title: 'Short Break', focus: 'Walk', completed: false, type: 'break' },
            { id: '11', start: '12:30', end: '13:30', title: 'Session 4: Language', focus: 'English / Hindi', completed: false, type: 'study' },
            { id: '12', start: '13:30', end: '14:30', title: 'Lunch & Power Nap', focus: 'Strict 20 min Nap', completed: false, type: 'break' },
            { id: '13', start: '14:30', end: '16:30', title: 'Session 5: Revision', focus: 'Active Recall, Notes', completed: false, type: 'study' },
            { id: '14', start: '16:30', end: '16:45', title: 'Tea/Coffee Break', focus: 'Caffeine Boost', completed: false, type: 'break' },
            { id: '15', start: '16:45', end: '18:15', title: 'Session 6: Practice', focus: 'Numericals (Maths/Phy)', completed: false, type: 'study' },
            { id: '16', start: '18:15', end: '18:30', title: 'Evening Walk', focus: 'Nature Time', completed: false, type: 'break' },
            { id: '17', start: '18:30', end: '19:45', title: 'Session 7: Self-Test', focus: 'Sample Paper Section', completed: false, type: 'study' },
            { id: '18', start: '19:45', end: '20:15', title: 'Dinner', focus: 'Family Time', completed: false, type: 'break' },
            { id: '19', start: '20:15', end: '20:30', title: 'Planning', focus: 'Plan for Tomorrow', completed: false, type: 'basic' },
            { id: '20', start: '20:30', end: '23:59', title: 'Sleep', focus: 'Good Night (8:30 PM)', completed: false, type: 'basic' },
            { id: '21', start: '00:00', end: '04:00', title: 'Sleep', focus: 'Deep Sleep', completed: false, type: 'basic' },
        ];

        // --- Utility Functions ---

        const getMinutes = (timeStr) => {
            const [h, m] = timeStr.split(':').map(Number);
            return h * 60 + m;
        };

        const getCurrentTimeMinutes = () => {
            const now = new Date();
            return now.getHours() * 60 + now.getMinutes();
        };

        const formatTime12Hr = (timeStr) => {
            const [h, m] = timeStr.split(':').map(Number);
            const ampm = h >= 12 ? 'PM' : 'AM';
            const h12 = h % 12 || 12;
            return `${h12}:${m.toString().padStart(2, '0')} ${ampm}`;
        };

        // --- Components ---

        const CalendarWidget = () => {
            const [currentDate, setCurrentDate] = useState(new Date());
            
            const getDaysInMonth = (year, month) => new Date(year, month + 1, 0).getDate();
            const getFirstDayOfMonth = (year, month) => new Date(year, month, 1).getDay();

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const today = new Date();

            const daysInMonth = getDaysInMonth(year, month);
            const firstDay = getFirstDayOfMonth(year, month);

            const days = [];
            for (let i = 0; i < firstDay; i++) {
                days.push(<div key={`empty-${i}`} />);
            }
            
            const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

            for (let i = 1; i <= daysInMonth; i++) {
                const isToday = i === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                const isExam = i === 12 && month === 1; // 12 Feb
                
                days.push(
                    <div 
                        key={`day-${i}`} 
                        className={`
                        aspect-square flex items-center justify-center rounded-lg text-sm font-bold relative transition-all
                        ${isToday ? 'bg-indigo-500 text-white shadow-lg shadow-indigo-500/40 scale-105' : 'text-slate-400 hover:bg-slate-800'}
                        ${isExam ? 'ring-2 ring-red-500 bg-red-900/30 text-red-100' : ''}
                        `}
                    >
                        {i}
                        {isExam && <span className="absolute -bottom-1 w-1 h-1 bg-red-500 rounded-full animate-pulse"></span>}
                    </div>
                );
            }

            const weekDays = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];

            const changeMonth = (offset) => {
                setCurrentDate(new Date(year, month + offset, 1));
            };

            return (
                <div className="bg-slate-800/80 backdrop-blur-sm p-6 rounded-3xl border border-slate-700 shadow-xl h-full">
                <div className="flex justify-between items-center mb-6">
                    <h3 className="font-bold text-xl text-white flex items-center gap-2">
                    <Icons.Calendar size={20} className="text-indigo-400" />
                    {months[month]} {year}
                    </h3>
                    <div className="flex gap-1 bg-slate-900/50 p-1 rounded-lg">
                        <button onClick={() => changeMonth(-1)} className="p-1 hover:bg-slate-700 rounded text-slate-400"><Icons.ChevronLeft size={18}/></button>
                        <button onClick={() => changeMonth(1)} className="p-1 hover:bg-slate-700 rounded text-slate-400"><Icons.ChevronRight size={18}/></button>
                    </div>
                </div>
                
                <div className="grid grid-cols-7 gap-2 text-center mb-3">
                    {weekDays.map((d, i) => (
                    <div key={`header-${i}`} className="text-xs uppercase font-bold text-slate-500">
                        {d}
                    </div>
                    ))}
                </div>
                
                <div className="grid grid-cols-7 gap-2">
                    {days}
                </div>
                <div className="mt-6 flex items-center gap-3 text-xs font-medium text-red-300 bg-red-900/20 p-3 rounded-xl border border-red-900/30">
                    <Icons.AlertTriangle size={16} />
                    <span>Target: Board Exams Start Feb 12</span>
                </div>
                </div>
            );
        };

        const CurrentSessionCard = ({ routine }) => {
            const [nowMin, setNowMin] = useState(getCurrentTimeMinutes());

            useEffect(() => {
                const timer = setInterval(() => setNowMin(getCurrentTimeMinutes()), 1000 * 30);
                return () => clearInterval(timer);
            }, []);

            const currentSession = routine.find(r => {
                const start = getMinutes(r.start);
                const end = getMinutes(r.end);
                if (r.start === '20:30' || r.start === '00:00') return nowMin >= start || nowMin < end;
                return nowMin >= start && nowMin < end;
            });

            const nextSession = currentSession 
                ? routine.find(r => getMinutes(r.start) === getMinutes(currentSession.end))
                : routine[0]; 

            if (!currentSession) return (
                <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 mb-6">
                <div className="text-slate-400">Rest / Prep Time</div>
                </div>
            );

            const endTime = getMinutes(currentSession.end);
            const startTime = getMinutes(currentSession.start);
            
            let progress = 0;
            let minsLeft = 0;
            
            if (currentSession.title === 'Sleep') {
                progress = 100;
                minsLeft = 0;
            } else {
                progress = Math.min(100, Math.max(0, ((nowMin - startTime) / (endTime - startTime)) * 100));
                minsLeft = Math.max(0, endTime - nowMin);
            }

            return (
                <div className="relative overflow-hidden bg-gradient-to-br from-indigo-600 to-violet-700 rounded-[2rem] p-6 shadow-2xl mb-8 transform transition-all hover:scale-[1.01]">
                <div className="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16"></div>
                
                <div className="absolute bottom-0 left-0 w-full h-1.5 bg-black/20">
                    <div className="h-full bg-white/90 transition-all duration-1000 ease-linear" style={{ width: `${progress}%` }}></div>
                </div>
                
                <div className="flex justify-between items-start mb-6 mt-1 relative z-10">
                    <div>
                    <span className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/20 text-white text-[10px] font-bold uppercase tracking-wider backdrop-blur-sm mb-3">
                        <span className="w-1.5 h-1.5 rounded-full bg-green-400 animate-pulse"></span> Live Now
                    </span>
                    <h2 className="text-2xl font-bold text-white leading-tight mb-1">{currentSession.title}</h2>
                    <p className="text-indigo-100 text-sm opacity-90 font-medium flex items-center gap-1">
                        {currentSession.focus}
                    </p>
                    </div>
                    <div className="text-right bg-white/10 p-3 rounded-2xl backdrop-blur-sm">
                    <div className="text-2xl font-mono font-bold text-white">{minsLeft}<span className="text-xs font-sans font-normal opacity-70 ml-1">min</span></div>
                    <div className="text-[10px] text-indigo-100 uppercase tracking-widest opacity-80">Time Left</div>
                    </div>
                </div>

                <div className="flex items-center gap-3 pt-4 border-t border-white/10 mt-2">
                    <div className="text-xs text-indigo-200 uppercase font-bold bg-black/10 px-2 py-1 rounded">Up Next:</div>
                    <div className="text-sm text-white font-medium truncate flex-1">{nextSession?.title || "End of Day"}</div>
                    <div className="text-xs text-indigo-100 font-mono bg-white/10 px-2 py-1 rounded">{nextSession ? formatTime12Hr(nextSession.start) : ""}</div>
                </div>
                </div>
            );
        };

        const FocusTimer = () => {
            const [timeLeft, setTimeLeft] = useState(25 * 60);
            const [isActive, setIsActive] = useState(false);
            const [mode, setMode] = useState('focus'); 

            useEffect(() => {
                let interval = null;
                if (isActive && timeLeft > 0) {
                    interval = setInterval(() => setTimeLeft(timeLeft - 1), 1000);
                } else if (timeLeft === 0) {
                    setIsActive(false);
                }
                return () => clearInterval(interval);
            }, [isActive, timeLeft]);

            const toggleTimer = () => setIsActive(!isActive);
            const resetTimer = () => {
                setIsActive(false);
                if (mode === 'focus') setTimeLeft(25 * 60);
                if (mode === 'short') setTimeLeft(5 * 60);
                if (mode === 'long') setTimeLeft(15 * 60);
            };

            const setTimerMode = (newMode) => {
                setMode(newMode);
                setIsActive(false);
                if (newMode === 'focus') setTimeLeft(25 * 60);
                if (newMode === 'short') setTimeLeft(5 * 60);
                if (newMode === 'long') setTimeLeft(15 * 60);
            };

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            return (
                <div className="bg-slate-800/80 backdrop-blur-md p-8 rounded-3xl border border-slate-700 shadow-xl">
                <div className="flex items-center justify-between mb-8">
                    <h3 className="text-lg font-bold text-white flex items-center gap-2">
                    <Icons.Clock className="w-5 h-5 text-indigo-400" /> Focus Timer
                    </h3>
                    <div className="flex bg-slate-900 rounded-xl p-1 gap-1">
                    {[
                        { id: 'focus', label: 'Focus' },
                        { id: 'short', label: 'Short Break' },
                        { id: 'long', label: 'Long Break' }
                    ].map((m) => (
                        <button
                        key={m.id}
                        onClick={() => setTimerMode(m.id)}
                        className={`px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${mode === m.id ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-400 hover:text-white'}`}
                        >
                        {m.label}
                        </button>
                    ))}
                    </div>
                </div>
                
                <div className="relative flex items-center justify-center mb-8">
                    <div className={`absolute inset-0 bg-indigo-500/20 blur-2xl rounded-full transform scale-75 transition-opacity duration-1000 ${isActive ? 'opacity-100' : 'opacity-0'}`}></div>
                    <div className="text-7xl font-mono font-bold text-white relative z-10 tracking-tighter tabular-nums">
                    {formatTime(timeLeft)}
                    </div>
                </div>

                <div className="flex justify-center gap-6">
                    <button 
                    onClick={toggleTimer} 
                    className={`h-16 w-16 rounded-2xl flex items-center justify-center transition-all transform active:scale-95 shadow-lg ${isActive ? 'bg-amber-500 hover:bg-amber-600 text-slate-900' : 'bg-indigo-600 hover:bg-indigo-500 text-white'}`}
                    >
                    {isActive ? <Icons.Pause size={32} fill="currentColor" /> : <Icons.Play size={32} fill="currentColor" className="ml-1" />}
                    </button>
                    <button 
                    onClick={resetTimer} 
                    className="h-16 w-16 rounded-2xl bg-slate-700 hover:bg-slate-600 text-slate-300 flex items-center justify-center transition-colors transform active:scale-95 shadow-lg"
                    >
                    <Icons.RotateCcw size={28} />
                    </button>
                </div>
                </div>
            );
        };

        const MistakeNotebook = () => {
            const [mistakes, setMistakes] = useState(() => {
                const saved = localStorage.getItem('sukhpreet_mistakes');
                return saved ? JSON.parse(saved) : [];
            });
            const [newMistake, setNewMistake] = useState('');
            const [subject, setSubject] = useState(SUBJECTS_DATA[0].name);

            useEffect(() => {
                localStorage.setItem('sukhpreet_mistakes', JSON.stringify(mistakes));
            }, [mistakes]);

            const addMistake = () => {
                if (!newMistake.trim()) return;
                setMistakes([{ id: Date.now(), text: newMistake, subject, date: new Date().toLocaleDateString('en-IN') }, ...mistakes]);
                setNewMistake('');
            };

            const removeMistake = (id) => {
                setMistakes(mistakes.filter(m => m.id !== id));
            };

            return (
                <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 h-full flex flex-col shadow-lg">
                <h3 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                    <Icons.FileWarning className="w-5 h-5 text-red-400" /> Mistake Log
                </h3>
                
                <div className="flex flex-col gap-3 mb-4">
                    <div className="flex gap-2">
                    <select 
                        value={subject} 
                        onChange={(e) => setSubject(e.target.value)}
                        className="bg-slate-900 border border-slate-700 text-slate-300 rounded-xl px-3 py-2.5 text-sm focus:outline-none focus:border-indigo-500 max-w-[100px]"
                    >
                        {SUBJECTS_DATA.map(s => <option key={s.id} value={s.name}>{s.name.split(' ')[0]}</option>)}
                    </select>
                    <input 
                        type="text" 
                        value={newMistake}
                        onChange={(e) => setNewMistake(e.target.value)}
                        placeholder="What went wrong?"
                        className="flex-1 bg-slate-900 border border-slate-700 rounded-xl px-4 py-2.5 text-white text-sm focus:outline-none focus:border-indigo-500 placeholder-slate-500"
                        onKeyDown={(e) => e.key === 'Enter' && addMistake()}
                    />
                    </div>
                    <button onClick={addMistake} className="bg-slate-700 hover:bg-slate-600 text-white py-2.5 rounded-xl text-sm font-semibold transition-colors border border-slate-600">
                    Log Mistake
                    </button>
                </div>

                <div className="flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-1 max-h-60">
                    {mistakes.length === 0 && <div className="text-center text-slate-500 text-sm py-4 italic">No mistakes logged yet. Good job!</div>}
                    {mistakes.map(m => (
                    <div key={m.id} className="bg-slate-900/50 p-3 rounded-xl border border-slate-700/50 group relative hover:border-slate-600 transition-all">
                        <div className="flex justify-between items-start mb-1">
                        <span className="text-[10px] font-bold text-indigo-300 bg-indigo-900/30 px-2 py-0.5 rounded border border-indigo-500/20">{m.subject}</span>
                        <span className="text-[10px] text-slate-500">{m.date}</span>
                        </div>
                        <p className="text-sm text-slate-300 leading-snug pr-6 mt-1">{m.text}</p>
                        <button 
                        onClick={() => removeMistake(m.id)}
                        className="absolute top-2 right-2 text-slate-600 hover:text-red-400 p-1 rounded-md hover:bg-slate-800 transition-all"
                        >
                        <Icons.Trash2 size={14} />
                        </button>
                    </div>
                    ))}
                </div>
                </div>
            );
        };

        const SyllabusTracker = () => {
            const [syllabus, setSyllabus] = useState(() => {
                const saved = localStorage.getItem('sukhpreet_syllabus');
                if (saved) return JSON.parse(saved);
                
                const initial = {};
                SUBJECTS_DATA.forEach(sub => {
                    initial[sub.id] = sub.chapters.map(ch => ({ name: ch, completed: false, revised: false }));
                });
                return initial;
            });

            const [activeSubject, setActiveSubject] = useState(SUBJECTS_DATA[0].id);

            useEffect(() => {
                localStorage.setItem('sukhpreet_syllabus', JSON.stringify(syllabus));
            }, [syllabus]);

            const toggleChapter = (subId, index, field) => {
                const newSubData = [...syllabus[subId]];
                newSubData[index] = { ...newSubData[index], [field]: !newSubData[index][field] };
                setSyllabus({ ...syllabus, [subId]: newSubData });
            };

            const calculateProgress = (subId) => {
                const chapters = syllabus[subId];
                if (!chapters) return 0;
                const done = chapters.filter(c => c.completed).length;
                return Math.round((done / chapters.length) * 100);
            };

            return (
                <div className="pb-24">
                <div className="flex overflow-x-auto gap-3 mb-6 pb-2 px-1 custom-scrollbar no-scrollbar">
                    {SUBJECTS_DATA.map(sub => (
                    <button
                        key={sub.id}
                        onClick={() => setActiveSubject(sub.id)}
                        className={`
                        flex-shrink-0 px-5 py-2.5 rounded-xl text-sm font-bold transition-all whitespace-nowrap shadow-sm
                        ${activeSubject === sub.id ? 'bg-indigo-600 text-white shadow-indigo-500/30 translate-y-[-2px]' : 'bg-slate-800 text-slate-400 hover:bg-slate-700 border border-slate-700'}
                        `}
                    >
                        {sub.name.split(' ')[0]}
                    </button>
                    ))}
                </div>

                <div className="bg-slate-800 rounded-2xl border border-slate-700 overflow-hidden shadow-xl">
                    <div className="p-6 border-b border-slate-700 flex justify-between items-center bg-slate-800/80 backdrop-blur-sm sticky top-0 z-10">
                    <div>
                        <h3 className="text-xl font-bold text-white">{SUBJECTS_DATA.find(s => s.id === activeSubject).name}</h3>
                        <p className="text-xs text-slate-400 mt-1">Chapter Tracker</p>
                    </div>
                    <div className="text-right">
                        <div className="text-3xl font-black text-indigo-400">{calculateProgress(activeSubject)}%</div>
                        <div className="text-[10px] text-slate-500 uppercase tracking-wider font-bold">Done</div>
                    </div>
                    </div>

                    <div className="divide-y divide-slate-700/50">
                    <div className="flex bg-slate-900/80 text-[10px] text-slate-400 uppercase font-bold py-3 px-4 tracking-wider">
                        <div className="flex-1">Chapter</div>
                        <div className="w-16 text-center">Done</div>
                        <div className="w-16 text-center">Revise</div>
                    </div>
                    {syllabus[activeSubject] && syllabus[activeSubject].map((chapter, idx) => (
                        <div key={idx} className="flex items-center p-4 hover:bg-slate-700/20 transition-colors group">
                        <div className={`flex-1 text-sm font-medium transition-colors ${chapter.completed ? 'text-slate-400 line-through decoration-slate-600' : 'text-slate-200'}`}>
                            {chapter.name}
                        </div>
                        <div className="w-16 flex justify-center">
                            <button 
                            onClick={() => toggleChapter(activeSubject, idx, 'completed')}
                            className={`p-2 rounded-lg transition-all ${chapter.completed ? 'bg-emerald-500/10 text-emerald-400' : 'text-slate-600 hover:bg-slate-700 hover:text-slate-300'}`}
                            >
                            {chapter.completed ? <Icons.CheckCircle2 size={20} /> : <Icons.Circle size={20} />}
                            </button>
                        </div>
                        <div className="w-16 flex justify-center">
                            <button 
                            onClick={() => toggleChapter(activeSubject, idx, 'revised')}
                            className={`p-2 rounded-lg transition-all ${chapter.revised ? 'bg-amber-500/10 text-amber-400' : 'text-slate-600 hover:bg-slate-700 hover:text-slate-300'}`}
                            >
                            {chapter.revised ? <Icons.CheckCircle2 size={20} /> : <Icons.Circle size={20} />}
                            </button>
                        </div>
                        </div>
                    ))}
                    </div>
                </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            const [routine, setRoutine] = useState(() => {
                const saved = localStorage.getItem('sukhpreet_routine_v2');
                return saved ? JSON.parse(saved) : DEFAULT_ROUTINE;
            });

            const [daysLeft, setDaysLeft] = useState(0);

            useEffect(() => {
                const diff = EXAM_DATE - new Date();
                setDaysLeft(Math.ceil(diff / (1000 * 60 * 60 * 24)));
            }, []);

            useEffect(() => {
                localStorage.setItem('sukhpreet_routine_v2', JSON.stringify(routine));
            }, [routine]);

            // Auto-reset routine at 3AM
            useEffect(() => {
                const checkReset = () => {
                const now = new Date();
                if (now.getHours() === 3 && now.getMinutes() === 0) {
                    const resetRoutine = routine.map(r => ({ ...r, completed: false }));
                    setRoutine(resetRoutine);
                }
                };
                const timer = setInterval(checkReset, 60000);
                return () => clearInterval(timer);
            }, [routine]);

            const toggleRoutineItem = (id) => {
                setRoutine(routine.map(r => r.id === id ? { ...r, completed: !r.completed } : r));
            };

            // Stats
            const completedCount = routine.filter(r => r.completed && r.type === 'study').length;
            const totalStudySessions = routine.filter(r => r.type === 'study').length;
            
            return (
                <div className="bg-[#0f172a] min-h-screen text-slate-100 font-sans pb-24 selection:bg-indigo-500/30">
                
                {/* Top Bar */}
                <header className="fixed top-0 w-full bg-[#0f172a]/90 backdrop-blur-xl border-b border-slate-800 z-50 shadow-sm">
                    <div className="max-w-md mx-auto px-5 h-16 flex items-center justify-between">
                    <div>
                        <h1 className="text-xl font-extrabold bg-gradient-to-r from-indigo-400 to-cyan-300 bg-clip-text text-transparent tracking-tight">
                        SUKHPREET'S ERA
                        </h1>
                        <p className="text-[10px] text-slate-500 font-mono uppercase tracking-widest font-semibold">Class 12 • Board Exams</p>
                    </div>
                    <div className="flex items-center gap-3">
                        <div className="text-right">
                            <div className="text-sm font-bold text-red-400">{daysLeft} Days</div>
                            <div className="text-[9px] text-slate-500 uppercase font-bold tracking-wider">Left</div>
                        </div>
                        <div className="h-9 w-9 rounded-full bg-slate-800 flex items-center justify-center border border-slate-700 shadow-sm">
                        <Icons.BellOff size={16} className="text-slate-400" />
                        </div>
                    </div>
                    </div>
                </header>

                {/* Main Content Area */}
                <main className="max-w-md mx-auto pt-24 px-5">
                    
                    {activeTab === 'home' && (
                    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
                        <CurrentSessionCard routine={routine} />
                        
                        <div className="flex justify-between items-end mb-4 px-1">
                        <div>
                            <h3 className="font-bold text-xl text-white">Today's Routine</h3>
                            <p className="text-xs text-slate-400">Discipline is success</p>
                        </div>
                        <div className="text-xs font-mono font-bold bg-slate-800 px-2 py-1 rounded text-indigo-400 border border-slate-700">
                            {completedCount}/{totalStudySessions} Sessions Done
                        </div>
                        </div>

                        <div className="space-y-3 pb-8">
                        {routine.map((item, index) => (
                            <div 
                            key={item.id}
                            className={`
                                relative p-4 rounded-2xl border transition-all duration-300 group
                                ${item.completed 
                                ? 'bg-slate-900/40 border-slate-800/50 opacity-60' 
                                : 'bg-slate-800 border-slate-700 shadow-md hover:border-slate-600'}
                                ${item.type === 'study' && !item.completed ? 'border-l-4 border-l-indigo-500' : ''}
                                ${item.type === 'break' && !item.completed ? 'border-l-4 border-l-emerald-500/50' : ''}
                            `}
                            >
                            <div className="flex items-start gap-4">
                                <button 
                                onClick={() => toggleRoutineItem(item.id)}
                                className={`mt-1 transition-transform active:scale-90 ${item.completed ? 'text-emerald-500' : 'text-slate-600 group-hover:text-indigo-400'}`}
                                >
                                {item.completed ? <Icons.CheckCircle2 size={26} className="fill-emerald-500/10" /> : <Icons.Circle size={26} strokeWidth={1.5} />}
                                </button>
                                <div className="flex-1 min-w-0">
                                <div className="flex justify-between items-start mb-1">
                                    <h4 className={`font-semibold text-[15px] truncate pr-2 ${item.completed ? 'text-slate-500 line-through decoration-2 decoration-slate-700' : 'text-slate-200'}`}>
                                    {item.title}
                                    </h4>
                                    <span className="text-[10px] font-mono text-slate-500 bg-slate-950 px-2 py-1 rounded-md whitespace-nowrap border border-slate-800">
                                    {formatTime12Hr(item.start)}
                                    </span>
                                </div>
                                <p className="text-xs text-slate-400 flex items-center gap-1.5">
                                    {item.type === 'study' && <Icons.Book size={10} />}
                                    {item.focus}
                                </p>
                                </div>
                            </div>
                            </div>
                        ))}
                        </div>
                    </div>
                    )}

                    {activeTab === 'syllabus' && (
                    <div className="animate-in fade-in slide-in-from-bottom-4 duration-500">
                        <div className="mb-8">
                        <h2 className="text-3xl font-black text-white mb-2 tracking-tight">Syllabus</h2>
                        <p className="text-sm text-slate-400">Track your progress. No blind spots.</p>
                        </div>
                        <SyllabusTracker />
                    </div>
                    )}

                    {activeTab === 'tools' && (
                    <div className="space-y-8 pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500">
                        <div className="mb-2">
                        <h2 className="text-3xl font-black text-white mb-2 tracking-tight">Command Center</h2>
                        <p className="text-sm text-slate-400">Tools for focus and improvement</p>
                        </div>
                        <FocusTimer />
                        <MistakeNotebook />
                    </div>
                    )}

                    {activeTab === 'stats' && (
                    <div className="pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500">
                        <div className="mb-8">
                        <h2 className="text-3xl font-black text-white mb-2 tracking-tight">Performance</h2>
                        <p className="text-sm text-slate-400">Analysis of your hard work</p>
                        </div>
                        
                        <div className="grid grid-cols-2 gap-4 mb-6">
                        <div className="bg-slate-800 p-5 rounded-2xl border border-slate-700 text-center shadow-lg">
                            <div className="text-4xl font-black text-indigo-400 mb-2">{completedCount}</div>
                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-wider">Sessions Done</div>
                        </div>
                        <div className="bg-slate-800 p-5 rounded-2xl border border-slate-700 text-center shadow-lg">
                            <div className="text-4xl font-black text-emerald-400 mb-2">
                            {totalStudySessions > 0 ? Math.round((completedCount/totalStudySessions)*100) : 0}%
                            </div>
                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-wider">Efficiency</div>
                        </div>
                        </div>

                        <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 mb-6 shadow-lg">
                        <h3 className="text-sm font-bold text-slate-300 mb-4 flex items-center gap-2">
                            <Icons.Target className="w-4 h-4 text-red-400" /> Exam Countdown
                        </h3>
                        <div className="w-full bg-slate-900 rounded-full h-3 mb-2 overflow-hidden border border-slate-700">
                            <div className="bg-gradient-to-r from-red-600 to-orange-500 h-full w-[85%] rounded-full"></div> 
                        </div>
                        <div className="flex justify-between text-[10px] font-bold text-slate-500 uppercase tracking-wider">
                            <span>Start</span>
                            <span>Feb 12</span>
                        </div>
                        </div>

                        <div className="bg-red-950/30 border border-red-900/50 p-6 rounded-2xl">
                        <h3 className="text-red-400 font-bold mb-3 flex items-center gap-2 text-sm uppercase tracking-wide">
                            <Icons.AlertTriangle size={16} /> Strict Rules
                        </h3>
                        <ul className="text-sm text-red-200/60 space-y-2.5 list-disc list-inside marker:text-red-500">
                            <li>No reels or shorts allowed.</li>
                            <li>Phone on 'Do Not Disturb' while studying.</li>
                            <li>Missed sessions must be compensated on Sunday.</li>
                            <li>Sleep at 8:30 PM is non-negotiable.</li>
                        </ul>
                        </div>
                    </div>
                    )}

                    {/* Planner Tab */}
                    {activeTab === 'planner' && (
                    <div className="pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500">
                        <div className="mb-8">
                        <h2 className="text-3xl font-black text-white mb-2 tracking-tight">Planner</h2>
                        <p className="text-sm text-slate-400">Monthly goals and deadlines</p>
                        </div>
                        <CalendarWidget />
                    </div>
                    )}

                </main>

                {/* Bottom Navigation */}
                <nav className="fixed bottom-0 w-full bg-[#0f172a]/95 backdrop-blur-md border-t border-slate-800 pb-safe z-50">
                    <div className="max-w-md mx-auto flex justify-around items-center h-[72px]">
                    <button 
                        onClick={() => setActiveTab('home')}
                        className={`flex flex-col items-center gap-1.5 transition-all w-16 ${activeTab === 'home' ? 'text-indigo-400 scale-110' : 'text-slate-500 hover:text-slate-300'}`}
                    >
                        <Icons.Home size={22} strokeWidth={activeTab === 'home' ? 2.5 : 2} />
                        <span className="text-[9px] font-bold tracking-wide">Routine</span>
                    </button>
                    
                    <button 
                        onClick={() => setActiveTab('syllabus')}
                        className={`flex flex-col items-center gap-1.5 transition-all w-16 ${activeTab === 'syllabus' ? 'text-indigo-400 scale-110' : 'text-slate-500 hover:text-slate-300'}`}
                    >
                        <Icons.BookOpen size={22} strokeWidth={activeTab === 'syllabus' ? 2.5 : 2} />
                        <span className="text-[9px] font-bold tracking-wide">Syllabus</span>
                    </button>

                    {/* Floating Action Button for Tools */}
                    <div className="relative -top-8 group">
                        <button 
                        onClick={() => setActiveTab('tools')}
                        className={`h-16 w-16 rounded-full flex items-center justify-center shadow-lg shadow-indigo-500/30 border-[6px] border-[#0f172a] transition-all duration-300 ${activeTab === 'tools' ? 'bg-indigo-500 text-white scale-110 rotate-180' : 'bg-slate-800 text-slate-400 hover:bg-slate-700'}`}
                        >
                        <Icons.BrainCircuit size={28} />
                        </button>
                        <span className="absolute -bottom-6 left-1/2 -translate-x-1/2 text-[9px] font-bold text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity">Tools</span>
                    </div>

                    <button 
                        onClick={() => setActiveTab('stats')}
                        className={`flex flex-col items-center gap-1.5 transition-all w-16 ${activeTab === 'stats' ? 'text-indigo-400 scale-110' : 'text-slate-500 hover:text-slate-300'}`}
                    >
                        <Icons.BarChart3 size={22} strokeWidth={activeTab === 'stats' ? 2.5 : 2} />
                        <span className="text-[9px] font-bold tracking-wide">Stats</span>
                    </button>
                    
                    <button 
                        onClick={() => setActiveTab('planner')} 
                        className={`flex flex-col items-center gap-1.5 transition-all w-16 ${activeTab === 'planner' ? 'text-indigo-400 scale-110' : 'text-slate-500 hover:text-slate-300'}`}
                    >
                        <Icons.Calendar size={22} strokeWidth={activeTab === 'planner' ? 2.5 : 2} />
                        <span className="text-[9px] font-bold tracking-wide">Plan</span>
                    </button>
                    </div>
                </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>